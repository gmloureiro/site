<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Admin SDR ‚Äì INBOTIX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Painel interno para gerenciar SDRs, cat√°logos e cadastros do marketplace INBOTIX.">
  <link rel="icon" type="image/png" href="logo-inbotix.png" />

  <!-- üî∂ TAG PH3A / DATAUNION -->
  <script async type="text/javascript" src="https://www.dataunion.com.br/bcf4a443-2a61-43a0-a3b7-b8ed1384c1a2"></script>

  <!-- Google tag (gtag.js) ‚Äì mesma usada nas outras p√°ginas -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17728268035"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17728268035');
  </script>

  <style>
    :root {
      --bg: #f3f4f6;
      --bg-card: #ffffff;
      --border: #d1d5db;
      --border-soft: #e5e7eb;
      --text: #111827;
      --muted: #6b7280;
      --primary: #0f6fff;
      --primary-dark: #0050c8;
      --danger: #b91c1c;
      --success: #15803d;
      --star-on: #fbbf24;
      --star-off: #e2e8f0;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top left, #e0ecff 0, #f9fafb 40%, #ffffff 100%);
      color: var(--text);
      min-height: 100vh;
    }

    a { color: inherit; text-decoration: none; }

    header {
      background: #ffffff;
      border-bottom: 1px solid rgba(148, 163, 184, 0.35);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.06);
      position: sticky;
      top: 0;
      z-index: 20;
    }

    .header-left { display: flex; align-items: center; gap: 10px; }
    .header-left img { height: 32px; width: auto; }

    .header-title {
      font-size: 13px;
      color: var(--muted);
    }
    .header-title strong {
      display: block;
      font-size: 15px;
      color: var(--text);
    }

    .header-right {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: flex-end;
    }

    .badge {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f9fafb;
      color: var(--muted);
    }

    .btn-outline-header {
      border-radius: 999px;
      border: 1px solid rgba(15, 111, 255, 0.5);
      padding: 6px 12px;
      font-size: 11px;
      color: var(--primary-dark);
      background: #eff6ff;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
    }

    .btn-outline-header span.icon {
      font-size: 13px;
    }

    main {
      max-width: 1140px;
      margin: 22px auto 32px;
      padding: 0 16px 40px;
    }

    .section {
      margin-bottom: 26px;
      background: var(--bg-card);
      border-radius: 18px;
      border: 1px solid var(--border-soft);
      box-shadow: 0 14px 32px rgba(15, 23, 42, 0.06);
      padding: 16px 18px 18px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: baseline;
      margin-bottom: 10px;
    }

    .section-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--text);
    }

    .section-subtitle {
      font-size: 11px;
      color: var(--muted);
      max-width: 60ch;
    }

    .section-badge {
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f9fafb;
      color: var(--muted);
      white-space: nowrap;
    }

    /* GRID CONFIG */
    .config-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    @media (max-width: 960px) {
      .config-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    @media (max-width: 720px) {
      .config-grid { grid-template-columns: minmax(0, 1fr); }
    }

    .config-card {
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      background: #f9fafb;
      padding: 10px 10px 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      min-height: 120px;
    }

    .config-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text);
    }

    .config-help {
      font-size: 10px;
      color: var(--muted);
    }

    .config-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 4px;
      min-height: 22px;
    }

    .config-tag {
      font-size: 10px;
      padding: 2px 7px;
      border-radius: 999px;
      background: #eef2ff;
      border: 1px solid #c7d2fe;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .config-tag button {
      border: none;
      background: transparent;
      font-size: 10px;
      cursor: pointer;
      color: #4b5563;
    }

    .config-input-row {
      display: flex;
      gap: 4px;
      margin-top: 6px;
    }

    .config-input-row input {
      flex: 1;
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 4px 8px;
      font-size: 11px;
      outline: none;
    }

    .config-input-row button {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #ffffff;
      padding: 4px 8px;
      font-size: 11px;
      cursor: pointer;
    }

    .config-footer {
      margin-top: 10px;
      font-size: 11px;
      color: var(--muted);
    }

    /* TOOLBARS & TABLES */
    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 8px;
    }

    .toolbar-info {
      font-size: 11px;
      color: var(--muted);
    }

    .toolbar-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .btn-small {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #ffffff;
      padding: 4px 9px;
      font-size: 11px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .btn-small.primary {
      border-color: transparent;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #ffffff;
      font-weight: 600;
      box-shadow: 0 8px 20px rgba(15, 111, 255, 0.5);
    }

    .btn-small.danger {
      border-color: rgba(185, 28, 28, 0.7);
      color: var(--danger);
      background: #fef2f2;
    }

    .table-wrapper {
      border-radius: 12px;
      border: 1px solid var(--border);
      overflow: auto;
      max-height: 360px;
      background: #f9fafb;
      margin-top: 6px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 11px;
      min-width: 720px;
    }

    thead {
      position: sticky;
      top: 0;
      background: #e5e7eb;
      z-index: 1;
    }

    th, td {
      padding: 6px 8px;
      border-bottom: 1px solid var(--border-soft);
      text-align: left;
      vertical-align: top;
    }

    th {
      font-weight: 600;
      color: #374151;
      border-bottom: 1px solid #d1d5db;
    }

    tr:nth-child(even) td { background: #f9fafb; }

    .empty {
      font-size: 12px;
      color: var(--muted);
      margin-top: 8px;
      text-align: center;
      padding: 8px;
    }

    .sdr-name {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .sdr-meta {
      font-size: 10px;
      color: var(--muted);
    }

    .stars {
      display: inline-flex;
      gap: 1px;
    }

    .star {
      color: var(--star-off);
      font-size: 13px;
    }

    .star.filled { color: var(--star-on); }

    .chip {
      display: inline-flex;
      align-items: center;
      padding: 2px 7px;
      border-radius: 999px;
      font-size: 10px;
      border: 1px solid var(--border);
      background: #f9fafb;
      margin: 1px;
      gap: 4px;
    }

    .chip-premium {
      border-color: #fbbf24;
      background: #fffbeb;
      color: #92400e;
    }

    .chip-verified {
      border-color: #22c55e;
      background: #ecfdf3;
      color: #166534;
    }

    .chip-stack {
      border-color: #60a5fa;
      background: #eff6ff;
      color: #1d4ed8;
    }

    .td-actions {
      white-space: nowrap;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .link-small {
      font-size: 10px;
      color: var(--primary-dark);
      text-decoration: underline;
      cursor: pointer;
      background: transparent;
      border: none;
      padding: 0;
    }

    .badge-pill {
      border-radius: 999px;
      font-size: 10px;
      padding: 3px 7px;
      background: #eff6ff;
      border: 1px solid #bfdbfe;
      color: #1d4ed8;
    }

    .badge-success {
      border-color: rgba(34, 197, 94, 0.6);
      color: var(--success);
      background: #ecfdf3;
    }

    .badge-danger {
      border-color: rgba(239, 68, 68, 0.6);
      color: var(--danger);
      background: #fef2f2;
    }

    /* MODAIS (edi√ß√£o + reviews) */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 40;
      padding: 16px;
    }

    .modal-backdrop.open {
      display: flex;
    }

    .modal {
      background: #ffffff;
      border-radius: 16px;
      max-width: 640px;
      width: 100%;
      max-height: 90vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: 0 24px 60px rgba(15, 23, 42, 0.6);
    }

    .modal-header {
      padding: 10px 14px;
      border-bottom: 1px solid var(--border-soft);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .modal-title {
      font-size: 14px;
      font-weight: 600;
    }

    .modal-subtitle {
      font-size: 11px;
      color: var(--muted);
    }

    .modal-close {
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #f9fafb;
      padding: 4px 9px;
      font-size: 11px;
      cursor: pointer;
    }

    .modal-body {
      font-size: 12px;
      color: var(--text);
      padding: 12px 14px 14px;
      overflow-y: auto;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 8px 10px;
    }

    @media (max-width: 640px) {
      .form-grid { grid-template-columns: minmax(0, 1fr); }
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 3px;
    }

    .form-label {
      font-size: 11px;
      color: var(--muted);
    }

    .form-control,
    .form-select {
      border-radius: 8px;
      border: 1px solid var(--border);
      padding: 5px 7px;
      font-size: 11px;
      outline: none;
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.4);
    }

    .form-row-inline {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      margin-top: 8px;
    }

    .form-footer {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
    }

    .btn-primary {
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #ffffff;
      padding: 6px 14px;
      font-size: 12px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 10px 24px rgba(15, 111, 255, 0.6);
    }

    .form-hint {
      font-size: 10px;
      color: var(--muted);
      max-width: 40ch;
    }

    .review-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .review-item {
      border-bottom: 1px solid var(--border-soft);
      padding-bottom: 6px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
    }

    .review-item:last-child { border-bottom: none; }

    .review-main {
      max-width: calc(100% - 70px);
    }

    .review-name { font-weight: 600; margin-bottom: 1px; }

    .review-meta {
      font-size: 10px;
      color: var(--muted);
      margin-top: 2px;
    }

    .review-actions {
      display: flex;
      flex-direction: column;
      gap: 4px;
      align-items: flex-end;
    }

    .review-empty {
      font-size: 11px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <header>
    <div class="header-left">
      <a href="https://inbotix.com.br" target="_blank" rel="noopener">
        <img src="logo-inbotix.png" alt="INBOTIX" />
      </a>
      <div class="header-title">
        <strong>Admin SDR ‚Äì INBOTIX</strong>
        Configura√ß√£o do marketplace e cadastros da plataforma.
      </div>
    </div>
    <div class="header-right">
      <span class="badge">Uso local em navegador ‚Äì ambiente de testes</span>
      <a href="sdr-lista.html" class="btn-outline-header">
        <span class="icon">üëÅ</span>
        Ver vitrine de SDRs
      </a>
      <a href="sdr-ranking.html" class="btn-outline-header">
        üèÜ Ranking de SDRs
      </a>
      <a href="sdr-cadastro.html" class="btn-outline-header">
        ‚ûï Cadastro de SDR
      </a>
    </div>
  </header>

  <main>
    <!-- CAT√ÅLOGOS -->
    <section class="section">
      <div class="section-header">
        <div>
          <div class="section-title">Cat√°logos para cadastro de SDR</div>
          <div class="section-subtitle">
            Aqui voc√™ define as op√ß√µes padr√£o de <strong>regi√£o, nicho, tipo de empresa, canais, idioma e experi√™ncia</strong>.
            O formul√°rio de cadastro e a vitrine usam estas listas para manter tudo padronizado.
          </div>
        </div>
        <span class="section-badge">Configura√ß√£o salva no navegador (localStorage)</span>
      </div>

      <div class="config-grid">
        <div class="config-card" data-key="regioes">
          <div class="config-title">Regi√µes de atua√ß√£o</div>
          <div class="config-help">Ex.: Brasil inteiro, Sudeste, Sul, LATAM...</div>
          <div class="config-tags" data-tags="regioes"></div>
          <div class="config-input-row">
            <input type="text" placeholder="Adicionar regi√£o..." />
            <button type="button">+ Adicionar</button>
          </div>
        </div>

        <div class="config-card" data-key="nichos">
          <div class="config-title">Nichos de atua√ß√£o</div>
          <div class="config-help">Ex.: SaaS, Ind√∫stria, Educa√ß√£o, Sa√∫de, Agro...</div>
          <div class="config-tags" data-tags="nichos"></div>
          <div class="config-input-row">
            <input type="text" placeholder="Adicionar nicho..." />
            <button type="button">+ Adicionar</button>
          </div>
        </div>

        <div class="config-card" data-key="tiposEmpresa">
          <div class="config-title">Tipos de empresa</div>
          <div class="config-help">Ex.: PME, Enterprise, Startup, Franquia...</div>
          <div class="config-tags" data-tags="tiposEmpresa"></div>
          <div class="config-input-row">
            <input type="text" placeholder="Adicionar tipo..." />
            <button type="button">+ Adicionar</button>
          </div>
        </div>

        <div class="config-card" data-key="canais">
          <div class="config-title">Canais de prospec√ß√£o</div>
          <div class="config-help">Ex.: LinkedIn, E-mail, WhatsApp, URA...</div>
          <div class="config-tags" data-tags="canais"></div>
          <div class="config-input-row">
            <input type="text" placeholder="Adicionar canal..." />
            <button type="button">+ Adicionar</button>
          </div>
        </div>

        <div class="config-card" data-key="idiomas">
          <div class="config-title">Idiomas</div>
          <div class="config-help">Ex.: Portugu√™s, Espanhol, Ingl√™s...</div>
          <div class="config-tags" data-tags="idiomas"></div>
          <div class="config-input-row">
            <input type="text" placeholder="Adicionar idioma..." />
            <button type="button">+ Adicionar</button>
          </div>
        </div>

        <div class="config-card" data-key="experiencia">
          <div class="config-title">Tempo de experi√™ncia</div>
          <div class="config-help">Ex.: J√∫nior, Pleno, S√™nior, +5 anos...</div>
          <div class="config-tags" data-tags="experiencia"></div>
          <div class="config-input-row">
            <input type="text" placeholder="Adicionar experi√™ncia..." />
            <button type="button">+ Adicionar</button>
          </div>
        </div>
      </div>

      <div class="config-footer">
        As altera√ß√µes s√£o salvas automaticamente. Em produ√ß√£o, esses cat√°logos podem ser carregados do banco/CRM,
        mas aqui j√° te d√£o uma vis√£o clara de como tudo pode ficar padronizado.
      </div>
    </section>

    <!-- CONTROLE DE SDRS -->
    <section class="section">
      <div class="section-header">
        <div>
          <div class="section-title">SDRs cadastrados</div>
          <div class="section-subtitle">
            Visualize, edite e marque selos como <strong>Premium</strong>, <strong>Top Performer</strong>,
            <strong>Verificado INBOTIX</strong> e <strong>Usa stack INBOTIX</strong>.
          </div>
        </div>
        <span class="section-badge">Fonte: localStorage ‚Äì chave <code>inbotix_sdrs</code></span>
      </div>

      <div class="toolbar">
        <div class="toolbar-info" id="sdr-info">Carregando SDRs...</div>
        <div class="toolbar-actions">
          <button type="button" class="btn-small" id="btn-export-sdrs">‚¨á Exportar SDRs (CSV)</button>
          <button type="button" class="btn-small" id="btn-reload">Recarregar lista</button>
          <button type="button" class="btn-small danger" id="btn-clear-all">
            Limpar todos os SDRs (apenas teste)
          </button>
        </div>
      </div>

      <div class="table-wrapper">
        <table id="sdr-table">
          <thead>
            <tr>
              <th>SDR</th>
              <th>Data cadastro</th>
              <th>Nichos &amp; Tipos de empresa</th>
              <th>Idioma &amp; Experi√™ncia</th>
              <th>Notas / Avalia√ß√µes</th>
              <th>Selos</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
      <div id="sdr-empty" class="empty" style="display:none;">
        Nenhum SDR cadastrado neste ambiente. Fa√ßa um teste em <strong>sdr-cadastro.html</strong> e depois volte aqui.
      </div>
    </section>

    <!-- CADASTROS DE EMPRESAS / AVALIADORES -->
    <section class="section">
      <div class="section-header">
        <div>
          <div class="section-title">Cadastros de empresas / avaliadores</div>
          <div class="section-subtitle">
            Toda pessoa que avalia um SDR vira um cadastro aqui: <strong>nome, empresa, e-mail, telefone, LinkedIn</strong>,
            mais a nota e o coment√°rio. Isso √© a sua futura base de leads para prospec√ß√£o.
          </div>
        </div>
        <span class="section-badge">Dados extra√≠dos das avalia√ß√µes dos SDRs</span>
      </div>

      <div class="toolbar">
        <div class="toolbar-info" id="reviews-info">
          Carregando cadastros de avaliadores...
        </div>
        <div class="toolbar-actions">
          <button type="button" class="btn-small" id="btn-export-reviews">
            ‚¨á Exportar avaliadores (CSV)
          </button>
        </div>
      </div>

      <div class="table-wrapper">
        <table id="reviews-table">
          <thead>
            <tr>
              <th>Data</th>
              <th>Nome do contato</th>
              <th>Empresa</th>
              <th>E-mail</th>
              <th>Telefone</th>
              <th>LinkedIn</th>
              <th>SDR avaliado</th>
              <th>Estrelas</th>
              <th>Coment√°rio</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
      <div id="reviews-empty" class="empty" style="display:none;">
        Ainda n√£o h√° avalia√ß√µes cadastradas neste ambiente. Assim que clientes avaliarem os SDRs na vitrine,
        os cadastros aparecer√£o aqui.
      </div>
    </section>

    <!-- NOVA SE√á√ÉO: LEADS QUE PEDIRAM O TELEFONE DO SDR -->
    <section class="section">
      <div class="section-header">
        <div>
          <div class="section-title">Leads que solicitaram o telefone do SDR</div>
          <div class="section-subtitle">
            Toda pessoa que preencheu o formul√°rio para liberar o n√∫mero de WhatsApp de um SDR aparece aqui.
            Esses dados v√™m da chave <code>inbotix_sdr_leads</code> no <strong>localStorage</strong>.
          </div>
        </div>
        <span class="section-badge badge-success" id="leads-badge">0 leads</span>
      </div>

      <div class="toolbar">
        <div class="toolbar-info" id="leads-info">
          Carregando leads...
        </div>
        <div class="toolbar-actions">
          <button type="button" class="btn-small primary" id="btn-export-leads-csv">‚¨á Exportar leads (CSV)</button>
          <button type="button" class="btn-small" id="btn-export-leads-json">‚¨á Exportar leads (JSON)</button>
          <button type="button" class="btn-small danger" id="btn-clear-leads">üóë Limpar leads (apenas teste)</button>
        </div>
      </div>

      <div class="table-wrapper">
        <table id="leads-table">
          <thead>
            <tr>
              <th>Data</th>
              <th>Contato / Empresa</th>
              <th>SDR</th>
              <th>E-mail</th>
              <th>Telefone</th>
            </tr>
          </thead>
          <tbody>
            <!-- preenchido via JS -->
          </tbody>
        </table>
      </div>
      <div id="leads-empty" class="empty" style="display:none;">
        Nenhum lead registrado ainda. Assim que algu√©m pedir o telefone de um SDR na vitrine, o cadastro aparece aqui.
      </div>
    </section>
  </main>

  <!-- MODAL EDI√á√ÉO DE SDR -->
  <div id="modal-edit" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <div>
          <div class="modal-title">Editar SDR</div>
          <div class="modal-subtitle">Ajuste os dados principais deste SDR.</div>
        </div>
        <button type="button" class="modal-close" id="close-edit">Fechar</button>
      </div>
      <div class="modal-body">
        <form id="edit-form">
          <input type="hidden" id="edit-id" />
          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="edit-nome">Nome do SDR</label>
              <input type="text" id="edit-nome" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-cidade">Cidade</label>
              <input type="text" id="edit-cidade" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-regiao">Regi√£o</label>
              <select id="edit-regiao" class="form-select"></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-idiomas">Idiomas</label>
              <select id="edit-idiomas" class="form-select" multiple></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-exp">Experi√™ncia</label>
              <select id="edit-exp" class="form-select"></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-nicho">Nichos</label>
              <select id="edit-nicho" class="form-select" multiple></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-tipos">Tipos de empresa</label>
              <select id="edit-tipos" class="form-select" multiple></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-canais">Canais</label>
              <select id="edit-canais" class="form-select" multiple></select>
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-telefone">Telefone</label>
              <input type="text" id="edit-telefone" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-whats">WhatsApp</label>
              <input type="text" id="edit-whats" class="form-control" />
            </div>
            <div class="form-group">
              <label class="form-label" for="edit-linkedin">LinkedIn</label>
              <input type="text" id="edit-linkedin" class="form-control" />
            </div>
          </div>

          <div class="form-row-inline">
            <div class="form-group">
              <label class="form-label">Selos</label>
              <div>
                <label style="font-size:11px; margin-right:8px;">
                  <input type="checkbox" id="edit-premium" /> Premium
                </label>
                <label style="font-size:11px; margin-right:8px;">
                  <input type="checkbox" id="edit-verified" /> Verificado INBOTIX
                </label>
                <label style="font-size:11px;">
                  <input type="checkbox" id="edit-usa-inbotix" /> Usa stack INBOTIX
                </label>
              </div>
            </div>
          </div>

          <div class="form-footer">
            <button type="submit" class="btn-primary">Salvar altera√ß√µes</button>
            <div class="form-hint">
              Para altera√ß√µes mais estruturais (novos nichos, regi√µes etc.), ajuste os cat√°logos acima.
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- MODAL AVALIA√á√ïES POR SDR -->
  <div id="modal-reviews" class="modal-backdrop">
    <div class="modal">
      <div class="modal-header">
        <div>
          <div class="modal-title" id="reviews-modal-title">Avalia√ß√µes deste SDR</div>
          <div class="modal-subtitle" id="reviews-modal-subtitle"></div>
        </div>
        <button type="button" class="modal-close" id="close-reviews">Fechar</button>
      </div>
      <div class="modal-body">
        <div id="reviews-list" class="review-list"></div>
        <div id="reviews-list-empty" class="review-empty" style="display:none;">
          Este SDR ainda n√£o possui avalia√ß√µes.
        </div>
      </div>
    </div>
  </div>

  <script>
    const CONFIG_KEY = "inbotix_sdr_config";
    const SDR_KEY = "inbotix_sdrs";
    const SDR_LEADS_KEY = "inbotix_sdr_leads";

    let config = null;
    let sdrs = [];
    let ratingMap = new Map();
    let topPerformerId = null;
    let allReviews = [];
    let leads = [];

    // DOM - SDRs
    const sdrTableBody = document.querySelector("#sdr-table tbody");
    const sdrInfo = document.getElementById("sdr-info");
    const sdrEmpty = document.getElementById("sdr-empty");

    // DOM - Reviews
    const reviewsTableBody = document.querySelector("#reviews-table tbody");
    const reviewsInfo = document.getElementById("reviews-info");
    const reviewsEmpty = document.getElementById("reviews-empty");

    // DOM - Leads
    const leadsTableBody = document.querySelector("#leads-table tbody");
    const leadsInfo = document.getElementById("leads-info");
    const leadsEmpty = document.getElementById("leads-empty");
    const leadsBadge = document.getElementById("leads-badge");

    // MODAL EDIT
    const modalEdit = document.getElementById("modal-edit");
    const closeEdit = document.getElementById("close-edit");
    const editForm = document.getElementById("edit-form");
    const editId = document.getElementById("edit-id");
    const editNome = document.getElementById("edit-nome");
    const editCidade = document.getElementById("edit-cidade");
    const editRegiao = document.getElementById("edit-regiao");
    const editIdiomas = document.getElementById("edit-idiomas");
    const editExp = document.getElementById("edit-exp");
    const editNicho = document.getElementById("edit-nicho");
    const editTipos = document.getElementById("edit-tipos");
    const editCanais = document.getElementById("edit-canais");
    const editTelefone = document.getElementById("edit-telefone");
    const editWhats = document.getElementById("edit-whats");
    const editLinkedin = document.getElementById("edit-linkedin");
    const editPremium = document.getElementById("edit-premium");
    const editVerified = document.getElementById("edit-verified");
    const editUsaInbotix = document.getElementById("edit-usa-inbotix");

    // MODAL REVIEWS
    const modalReviews = document.getElementById("modal-reviews");
    const closeReviews = document.getElementById("close-reviews");
    const reviewsModalTitle = document.getElementById("reviews-modal-title");
    const reviewsModalSubtitle = document.getElementById("reviews-modal-subtitle");
    const reviewsList = document.getElementById("reviews-list");
    const reviewsListEmpty = document.getElementById("reviews-list-empty");

    // BOT√ïES
    const btnExportSdrs = document.getElementById("btn-export-sdrs");
    const btnReload = document.getElementById("btn-reload");
    const btnClearAll = document.getElementById("btn-clear-all");
    const btnExportReviews = document.getElementById("btn-export-reviews");

    const btnExportLeadsCsv = document.getElementById("btn-export-leads-csv");
    const btnExportLeadsJson = document.getElementById("btn-export-leads-json");
    const btnClearLeads = document.getElementById("btn-clear-leads");

    /* ---------- CONFIG ---------- */

    function defaultConfig() {
      return {
        regioes: ["Brasil inteiro", "Sudeste", "Sul", "Nordeste", "Centro-Oeste", "LATAM", "Europa"],
        nichos: ["SaaS", "Ind√∫stria", "Educa√ß√£o", "Sa√∫de", "Tecnologia", "Ag√™ncias de marketing"],
        tiposEmpresa: ["PME", "Enterprise", "Startup", "Franquia"],
        canais: ["LinkedIn", "E-mail", "WhatsApp", "Telefone", "URA"],
        idiomas: ["Portugu√™s", "Espanhol", "Ingl√™s"],
        experiencia: ["J√∫nior", "Pleno", "S√™nior", "+5 anos"]
      };
    }

    function loadConfig() {
      try {
        const raw = localStorage.getItem(CONFIG_KEY);
        if (!raw) throw new Error("Sem config");
        config = JSON.parse(raw);
      } catch (e) {
        config = defaultConfig();
        saveConfig();
      }
      renderConfig();
    }

    function saveConfig() {
      localStorage.setItem(CONFIG_KEY, JSON.stringify(config));
      renderConfig();
    }

    function renderConfig() {
      const cards = document.querySelectorAll(".config-card");
      cards.forEach(card => {
        const key = card.dataset.key;
        const listElem = card.querySelector(".config-tags");
        const input = card.querySelector(".config-input-row input");
        const btn = card.querySelector(".config-input-row button");

        const values = Array.isArray(config[key]) ? config[key] : [];

        listElem.innerHTML = "";
        if (!values.length) {
          const span = document.createElement("span");
          span.className = "config-help";
          span.textContent = "Nenhum item cadastrado ainda.";
          listElem.appendChild(span);
        } else {
          values.forEach((val, index) => {
            const tag = document.createElement("span");
            tag.className = "config-tag";
            tag.innerHTML = `<span>${val}</span>`;
            const removeBtn = document.createElement("button");
            removeBtn.type = "button";
            removeBtn.textContent = "√ó";
            removeBtn.title = "Remover";
            removeBtn.addEventListener("click", () => {
              config[key].splice(index, 1);
              saveConfig();
            });
            tag.appendChild(removeBtn);
            listElem.appendChild(tag);
          });
        }

        btn.onclick = () => {
          const v = (input.value || "").trim();
          if (!v) return;
          if (!config[key]) config[key] = [];
          if (!config[key].includes(v)) {
            config[key].push(v);
            saveConfig();
          }
          input.value = "";
        };
      });

      // Atualiza selects do modal com base no config
      fillSelectFromConfig(editRegiao, config.regioes || [], false);
      fillSelectFromConfig(editIdiomas, config.idiomas || [], true);
      fillSelectFromConfig(editExp, config.experiencia || [], false);
      fillSelectFromConfig(editNicho, config.nichos || [], true);
      fillSelectFromConfig(editTipos, config.tiposEmpresa || [], true);
      fillSelectFromConfig(editCanais, config.canais || [], true);
    }

    /* ---------- SDRS E REVIEWS ---------- */

    function loadSdrs() {
      try {
        sdrs = JSON.parse(localStorage.getItem(SDR_KEY) || "[]");
      } catch (e) {
        console.warn("Erro ao carregar SDRs", e);
        sdrs = [];
      }
      sdrs = sdrs.map(s => ({
        reviews: Array.isArray(s.reviews) ? s.reviews : [],
        premium: !!s.premium,
        verified: !!s.verified,
        usaInbotix: !!s.usaInbotix,
        createdAt: s.createdAt || new Date().toISOString(),
        ...s
      }));

      recomputeRatings();
      computeTopPerformer();
      buildAllReviews();
      renderSdrTable();
      renderReviewsTable();
    }

    function saveSdrs() {
      localStorage.setItem(SDR_KEY, JSON.stringify(sdrs));
      recomputeRatings();
      computeTopPerformer();
      buildAllReviews();
      renderSdrTable();
      renderReviewsTable();
    }

    function recomputeRatings() {
      ratingMap = new Map();
      sdrs.forEach(sdr => {
        const revs = sdr.reviews || [];
        if (!revs.length) {
          ratingMap.set(sdr.id, { avg: 0, count: 0 });
          return;
        }
        const sum = revs.reduce((acc, r) => acc + (r.stars || 0), 0);
        ratingMap.set(sdr.id, { avg: sum / revs.length, count: revs.length });
      });
    }

    function computeTopPerformer() {
      let bestId = null;
      let bestScore = -1;
      sdrs.forEach(sdr => {
        const info = ratingMap.get(sdr.id) || { avg: 0, count: 0 };
        const score = info.avg * (1 + info.count / 10);
        if (info.count > 0 && score > bestScore) {
          bestScore = score;
          bestId = sdr.id;
        }
      });
      topPerformerId = bestId;
    }

    function buildAllReviews() {
      allReviews = [];
      sdrs.forEach(sdr => {
        (sdr.reviews || []).forEach(r => {
          allReviews.push({
            ...r,
            sdrId: sdr.id,
            sdrNome: sdr.nome || "SDR"
          });
        });
      });
    }

    function createStars(avg) {
      const div = document.createElement("div");
      div.className = "stars";
      const rounded = Math.round(avg * 2) / 2;
      for (let i = 1; i <= 5; i++) {
        const span = document.createElement("span");
        span.className = "star" + (i <= Math.round(rounded) ? " filled" : "");
        span.textContent = "‚òÖ";
        div.appendChild(span);
      }
      return div;
    }

    function formatDate(d) {
      if (!d) return "-";
      const dt = new Date(d);
      if (isNaN(dt.getTime())) return "-";
      return dt.toLocaleDateString("pt-BR");
    }

    /* ---------- TABELA DE SDRS ---------- */

    function renderSdrTable() {
      sdrTableBody.innerHTML = "";
      if (!sdrs.length) {
        sdrEmpty.style.display = "block";
        sdrInfo.textContent = "0 SDRs cadastrados neste ambiente.";
        return;
      }
      sdrEmpty.style.display = "none";
      sdrInfo.textContent = sdrs.length + (sdrs.length === 1 ? " SDR cadastrado." : " SDRs cadastrados.");

      sdrs.forEach(sdr => {
        const tr = document.createElement("tr");
        const info = ratingMap.get(sdr.id) || { avg: 0, count: 0 };

        // SDR
        const tdSdr = document.createElement("td");
        const nameEl = document.createElement("div");
        nameEl.className = "sdr-name";
        nameEl.textContent = sdr.nome || "SDR";
        const metaEl = document.createElement("div");
        metaEl.className = "sdr-meta";
        metaEl.textContent = (sdr.cidade || "") + (sdr.regioes ? " ‚Ä¢ " + sdr.regioes : "");
        tdSdr.appendChild(nameEl);
        tdSdr.appendChild(metaEl);
        tr.appendChild(tdSdr);

        // Data
        const tdData = document.createElement("td");
        tdData.textContent = formatDate(sdr.createdAt);
        tr.appendChild(tdData);

        // Nichos & tipos
        const tdNr = document.createElement("td");
        tdNr.innerHTML =
          "<div><strong>Nichos:</strong> " + (sdr.nicho || "-") + "</div>" +
          "<div><strong>Tipos de empresa:</strong> " + (sdr.tiposEmpresa || "-") + "</div>";
        tr.appendChild(tdNr);

        // Idioma & experi√™ncia
        const tdIe = document.createElement("td");
        tdIe.innerHTML =
          "<div><strong>Idioma:</strong> " + (sdr.idiomas || "-") + "</div>" +
          "<div><strong>Experi√™ncia:</strong> " + (sdr.tempoExp || "-") + "</div>" +
          "<div><strong>Canais:</strong> " + (sdr.canais || "-") + "</div>";
        tr.appendChild(tdIe);

        // Notas
        const tdNotas = document.createElement("td");
        if (info.count) {
          const stars = createStars(info.avg);
          const detail = document.createElement("div");
          detail.style.fontSize = "10px";
          detail.style.color = "#4b5563";
          detail.textContent =
            info.avg.toFixed(1).replace(".", ",") +
            " de m√©dia em " +
            info.count +
            (info.count === 1 ? " avalia√ß√£o" : " avalia√ß√µes");
          tdNotas.appendChild(stars);
          tdNotas.appendChild(detail);
        } else {
          tdNotas.innerHTML = '<span class="sdr-meta">Sem avalia√ß√µes ainda</span>';
        }
        tr.appendChild(tdNotas);

        // Selos
        const tdSelos = document.createElement("td");
        if (sdr.premium) {
          const chipP = document.createElement("span");
          chipP.className = "chip chip-premium";
          chipP.textContent = "Premium";
          tdSelos.appendChild(chipP);
        }
        if (sdr.id === topPerformerId) {
          const chipT = document.createElement("span");
          chipT.className = "chip";
          chipT.textContent = "Top Performer";
          tdSelos.appendChild(chipT);
        }
        if (sdr.verified) {
          const chipV = document.createElement("span");
          chipV.className = "chip chip-verified";
          chipV.textContent = "Verificado INBOTIX";
          tdSelos.appendChild(chipV);
        }
        if (sdr.usaInbotix) {
          const chipI = document.createElement("span");
          chipI.className = "chip chip-stack";
          chipI.textContent = "Usa stack INBOTIX";
          tdSelos.appendChild(chipI);
        }
        if (!tdSelos.innerHTML) tdSelos.textContent = "‚Äî";
        tr.appendChild(tdSelos);

        // A√ß√µes
        const tdActions = document.createElement("td");
        tdActions.className = "td-actions";

        const btnEdit = document.createElement("button");
        btnEdit.type = "button";
        btnEdit.className = "link-small";
        btnEdit.textContent = "‚úè Editar";
        btnEdit.addEventListener("click", () => openEditModal(sdr.id));
        tdActions.appendChild(btnEdit);

        const btnSelos = document.createElement("button");
        btnSelos.type = "button";
        btnSelos.className = "link-small";
        btnSelos.textContent = "üèÖ Selos";
        btnSelos.addEventListener("click", () => toggleSelos(sdr.id));
        tdActions.appendChild(btnSelos);

        const btnRev = document.createElement("button");
        btnRev.type = "button";
        btnRev.className = "link-small";
        btnRev.textContent = "‚≠ê Avalia√ß√µes";
        btnRev.addEventListener("click", () => openReviewsModal(sdr.id));
        tdActions.appendChild(btnRev);

        const btnDel = document.createElement("button");
        btnDel.type = "button";
        btnDel.className = "link-small";
        btnDel.style.color = "#b91c1c";
        btnDel.textContent = "üóë Apagar";
        btnDel.addEventListener("click", () => deleteSdr(sdr.id));
        tdActions.appendChild(btnDel);

        tr.appendChild(tdActions);

        sdrTableBody.appendChild(tr);
      });
    }

    function toggleSelos(id) {
      const idx = sdrs.findIndex(s => s.id === id);
      if (idx === -1) return;
      const sdr = sdrs[idx];

      const premium = confirm("Marcar / desmarcar este SDR como PREMIUM?\nOK = alternar status.");
      if (premium) sdr.premium = !sdr.premium;

      const verified = confirm("Marcar / desmarcar este SDR como VERIFICADO INBOTIX?\nOK = alternar status.");
      if (verified) sdr.verified = !sdr.verified;

      const inb = confirm("Marcar / desmarcar que este SDR usa stack INBOTIX?\nOK = alternar status.");
      if (inb) sdr.usaInbotix = !sdr.usaInbotix;

      saveSdrs();
    }

    function deleteSdr(id) {
      if (!confirm("Tem certeza que deseja remover este SDR? Esta a√ß√£o n√£o pode ser desfeita neste ambiente.")) return;
      sdrs = sdrs.filter(s => s.id !== id);
      saveSdrs();
    }

    /* ---------- TABELA DE AVALIADORES ---------- */

    function renderReviewsTable() {
      reviewsTableBody.innerHTML = "";
      if (!allReviews.length) {
        reviewsEmpty.style.display = "block";
        reviewsInfo.textContent = "0 avalia√ß√£o encontrada neste ambiente.";
        return;
      }
      reviewsEmpty.style.display = "none";
      reviewsInfo.textContent =
        allReviews.length +
        (allReviews.length === 1 ? " avalia√ß√£o cadastrada." : " avalia√ß√µes cadastradas.");

      allReviews
        .slice()
        .sort((a, b) => (a.date || "").localeCompare(b.date || ""))
        .forEach(r => {
          const tr = document.createElement("tr");

          const tdData = document.createElement("td");
          tdData.textContent = formatDate(r.date);
          tr.appendChild(tdData);

          const tdNome = document.createElement("td");
          tdNome.textContent = r.clientName || "";
          tr.appendChild(tdNome);

          const tdEmpresa = document.createElement("td");
          tdEmpresa.textContent = r.clientCompany || "";
          tr.appendChild(tdEmpresa);

          const tdEmail = document.createElement("td");
          tdEmail.textContent = r.clientEmail || "";
          tr.appendChild(tdEmail);

          const tdTel = document.createElement("td");
          tdTel.textContent = r.clientPhone || "";
          tr.appendChild(tdTel);

          const tdLinkedin = document.createElement("td");
          tdLinkedin.textContent = r.clientLinkedin || "";
          tr.appendChild(tdLinkedin);

          const tdSdr = document.createElement("td");
          tdSdr.textContent = r.sdrNome || "";
          tr.appendChild(tdSdr);

          const tdStars = document.createElement("td");
          tdStars.textContent = (r.stars || 0) + "‚òÖ";
          tr.appendChild(tdStars);

          const tdComment = document.createElement("td");
          tdComment.textContent = r.comment || "";
          tr.appendChild(tdComment);

          reviewsTableBody.appendChild(tr);
        });
    }

    /* ---------- MODAL EDIT ---------- */

    function fillSelectFromConfig(selectElem, arr, multiple) {
      selectElem.innerHTML = "";
      const values = Array.isArray(arr) ? arr : [];
      if (!multiple) {
        const optEmpty = document.createElement("option");
        optEmpty.value = "";
        optEmpty.textContent = "Selecione...";
        selectElem.appendChild(optEmpty);
      }
      values.forEach(v => {
        const opt = document.createElement("option");
        opt.value = v;
        opt.textContent = v;
        selectElem.appendChild(opt);
      });
    }

    function openEditModal(id) {
      const sdr = sdrs.find(s => s.id === id);
      if (!sdr) return;

      editId.value = sdr.id || "";
      editNome.value = sdr.nome || "";
      editCidade.value = sdr.cidade || "";
      editRegiao.value = sdr.regioes || "";

      setMultiSelect(editIdiomas, sdr.idiomas);
      setMultiSelect(editNicho, sdr.nicho);
      setMultiSelect(editTipos, sdr.tiposEmpresa);
      setMultiSelect(editCanais, sdr.canais);

      editExp.value = sdr.tempoExp || "";
      editTelefone.value = sdr.telefone || "";
      editWhats.value = sdr.whats || "";
      editLinkedin.value = sdr.linkedin || "";

      editPremium.checked = !!sdr.premium;
      editVerified.checked = !!sdr.verified;
      editUsaInbotix.checked = !!sdr.usaInbotix;

      modalEdit.classList.add("open");
    }

    function closeEditModal() {
      modalEdit.classList.remove("open");
    }

    function setMultiSelect(select, valueStr) {
      const values = (valueStr || "")
        .split(",")
        .map(v => v.trim())
        .filter(Boolean);
      Array.from(select.options).forEach(opt => {
        opt.selected = values.includes(opt.value);
      });
    }

    function getMultiSelectValue(select) {
      const selected = Array.from(select.selectedOptions).map(o => o.value.trim()).filter(Boolean);
      return selected.join(", ");
    }

    closeEdit.addEventListener("click", closeEditModal);
    modalEdit.addEventListener("click", (e) => {
      if (e.target === modalEdit) closeEditModal();
    });

    editForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const id = editId.value;
      const idx = sdrs.findIndex(s => s.id === id);
      if (idx === -1) return;
      const sdr = sdrs[idx];

      sdr.nome = editNome.value.trim();
      sdr.cidade = editCidade.value.trim();
      sdr.regioes = editRegiao.value;
      sdr.idiomas = getMultiSelectValue(editIdiomas);
      sdr.tempoExp = editExp.value;
      sdr.nicho = getMultiSelectValue(editNicho);
      sdr.tiposEmpresa = getMultiSelectValue(editTipos);
      sdr.canais = getMultiSelectValue(editCanais);
      sdr.telefone = editTelefone.value.trim();
      sdr.whats = editWhats.value.trim();
      sdr.linkedin = editLinkedin.value.trim();
      sdr.premium = editPremium.checked;
      sdr.verified = editVerified.checked;
      sdr.usaInbotix = editUsaInbotix.checked;

      saveSdrs();
      closeEditModal();
    });

    /* ---------- MODAL REVIEWS POR SDR ---------- */

    function openReviewsModal(id) {
      const sdr = sdrs.find(s => s.id === id);
      if (!sdr) return;
      const info = ratingMap.get(sdr.id) || { avg: 0, count: 0 };
      reviewsModalTitle.textContent = "Avalia√ß√µes de " + (sdr.nome || "SDR");
      reviewsModalSubtitle.textContent = info.count
        ? info.avg.toFixed(1).replace(".", ",") + " de m√©dia em " + info.count +
          (info.count === 1 ? " avalia√ß√£o" : " avalia√ß√µes")
        : "Sem avalia√ß√µes cadastradas ainda.";

      reviewsList.innerHTML = "";
      const revs = sdr.reviews || [];
      if (!revs.length) {
        reviewsListEmpty.style.display = "block";
      } else {
        reviewsListEmpty.style.display = "none";
        revs
          .slice()
          .sort((a, b) => (a.date || "").localeCompare(b.date || ""))
          .forEach((r, index) => {
            const item = document.createElement("div");
            item.className = "review-item";

            const main = document.createElement("div");
            main.className = "review-main";

            const name = document.createElement("div");
            name.className = "review-name";
            name.textContent = (r.clientName || "Cliente") + " ‚Ä¢ " + (r.clientCompany || "");
            main.appendChild(name);

            const comment = document.createElement("div");
            comment.textContent = r.comment || "";
            main.appendChild(comment);

            const meta = document.createElement("div");
            meta.className = "review-meta";
            const dt = r.date ? new Date(r.date) : null;
            meta.textContent =
              (r.stars || 0) +
              "‚òÖ ‚Ä¢ " +
              (dt ? dt.toLocaleDateString("pt-BR") : "") +
              (r.clientEmail ? " ‚Ä¢ " + r.clientEmail : "");
            main.appendChild(meta);

            const actions = document.createElement("div");
            actions.className = "review-actions";
            const btnDel = document.createElement("button");
            btnDel.type = "button";
            btnDel.className = "link-small";
            btnDel.style.color = "#b91c1c";
            btnDel.textContent = "Remover";
            btnDel.addEventListener("click", () => {
              if (!confirm("Remover esta avalia√ß√£o?")) return;
              sdr.reviews.splice(index, 1);
              saveSdrs();
              openReviewsModal(id);
            });
            actions.appendChild(btnDel);

            item.appendChild(main);
            item.appendChild(actions);
            reviewsList.appendChild(item);
          });
      }

      modalReviews.classList.add("open");
    }

    function closeReviewsModal() {
      modalReviews.classList.remove("open");
    }

    closeReviews.addEventListener("click", closeReviewsModal);
    modalReviews.addEventListener("click", (e) => {
      if (e.target === modalReviews) closeReviewsModal();
    });

    /* ---------- EXPORT CSV GEN√âRICO ---------- */

    function downloadCsv(filename, headers, rows) {
      const escape = (val) => {
        if (val == null) return "";
        const str = String(val).replace(/"/g, '""');
        return `"${str}"`;
      };
      const lines = [];
      lines.push(headers.map(escape).join(";"));
      rows.forEach(row => {
        lines.push(row.map(escape).join(";"));
      });
      const blob = new Blob([lines.join("\n")], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    // Export SDRs
    btnExportSdrs.addEventListener("click", () => {
      if (!sdrs.length) {
        alert("N√£o h√° SDRs para exportar.");
        return;
      }
      const headers = [
        "ID",
        "Data cadastro",
        "Nome",
        "Cidade",
        "Regi√£o",
        "Idioma",
        "Tempo experi√™ncia",
        "Nichos",
        "Tipos de empresa",
        "Canais",
        "Telefone",
        "WhatsApp",
        "LinkedIn",
        "Premium",
        "Verificado INBOTIX",
        "Usa stack INBOTIX",
        "Qtd avalia√ß√µes",
        "M√©dia estrelas"
      ];
      const rows = sdrs.map(s => {
        const info = ratingMap.get(s.id) || { avg: 0, count: 0 };
        return [
          s.id || "",
          formatDate(s.createdAt),
          s.nome || "",
          s.cidade || "",
          s.regioes || "",
          s.idiomas || "",
          s.tempoExp || "",
          s.nicho || "",
          s.tiposEmpresa || "",
          s.canais || "",
          s.telefone || "",
          s.whats || "",
          s.linkedin || "",
          s.premium ? "Sim" : "N√£o",
          s.verified ? "Sim" : "N√£o",
          s.usaInbotix ? "Sim" : "N√£o",
          info.count || 0,
          info.count ? info.avg.toFixed(2).replace(".", ",") : ""
        ];
      });
      downloadCsv("sdrs_inbotix.csv", headers, rows);
    });

    // Export Avaliadores
    btnExportReviews.addEventListener("click", () => {
      if (!allReviews.length) {
        alert("N√£o h√° avalia√ß√µes para exportar.");
        return;
      }
      const headers = [
        "Data avalia√ß√£o",
        "Nome contato",
        "Empresa",
        "E-mail",
        "Telefone",
        "LinkedIn",
        "SDR avaliado",
        "Estrelas",
        "Coment√°rio"
      ];
      const rows = allReviews.map(r => [
        formatDate(r.date),
        r.clientName || "",
        r.clientCompany || "",
        r.clientEmail || "",
        r.clientPhone || "",
        r.clientLinkedin || "",
        r.sdrNome || "",
        r.stars || 0,
        r.comment || ""
      ]);
      downloadCsv("avaliadores_inbotix.csv", headers, rows);
    });

    /* ---------- LEADS QUE PEDIRAM TELEFONE ---------- */

    function loadLeads() {
      try {
        leads = JSON.parse(localStorage.getItem(SDR_LEADS_KEY) || "[]");
      } catch (e) {
        leads = [];
      }
      leads.sort((a, b) => {
        const da = a.createdAt ? new Date(a.createdAt).getTime() : 0;
        const db = b.createdAt ? new Date(b.createdAt).getTime() : 0;
        return db - da;
      });
      renderLeadsTable();
    }

    function renderLeadsTable() {
      leadsTableBody.innerHTML = "";
      const total = leads.length;
      leadsInfo.textContent =
        total + (total === 1 ? " lead registrado." : " leads registrados.");

      leadsBadge.textContent = total + (total === 1 ? " lead" : " leads");
      leadsBadge.classList.remove("badge-success", "badge-danger");
      leadsBadge.classList.add(total ? "badge-danger" : "badge-success");

      if (!total) {
        leadsEmpty.style.display = "block";
        return;
      }
      leadsEmpty.style.display = "none";

      leads.forEach(l => {
        const tr = document.createElement("tr");

        const dt = l.createdAt ? new Date(l.createdAt) : null;
        const dataStr = dt
          ? dt.toLocaleDateString("pt-BR") +
            " " +
            dt.toLocaleTimeString("pt-BR", { hour: "2-digit", minute: "2-digit" })
          : "-";

        const sdrNome = l.sdrNome || (() => {
          const s = sdrs.find(s => s.id === l.sdrId);
          return s ? s.nome : "";
        })();

        const tdData = document.createElement("td");
        tdData.textContent = dataStr;
        tr.appendChild(tdData);

        const tdContato = document.createElement("td");
        tdContato.innerHTML =
          "<strong>" + (l.nome || "-") + "</strong><br>" +
          '<span class="sdr-meta">' + (l.empresa || "-") + "</span>";
        tr.appendChild(tdContato);

        const tdSdr = document.createElement("td");
        tdSdr.innerHTML =
          "<span class='sdr-meta'>#" +
          (l.sdrId || "-") +
          " ‚Ä¢ " +
          (sdrNome || "") +
          "</span>";
        tr.appendChild(tdSdr);

        const tdEmail = document.createElement("td");
        tdEmail.textContent = l.email || "-";
        tr.appendChild(tdEmail);

        const tdTel = document.createElement("td");
        tdTel.textContent = l.telefone || "-";
        tr.appendChild(tdTel);

        leadsTableBody.appendChild(tr);
      });
    }

    function exportLeadsCsv() {
      if (!leads.length) {
        alert("N√£o h√° leads para exportar.");
        return;
      }
      const headers = [
        "id",
        "sdrId",
        "sdrNome",
        "nome",
        "empresa",
        "email",
        "telefone",
        "createdAt"
      ];
      const rows = leads.map(l => [
        l.id || "",
        l.sdrId || "",
        l.sdrNome || "",
        l.nome || "",
        l.empresa || "",
        l.email || "",
        l.telefone || "",
        l.createdAt || ""
      ]);
      downloadCsv("inbotix_sdr_leads.csv", headers, rows);
    }

    function exportLeadsJson() {
      if (!leads.length) {
        alert("N√£o h√° leads para exportar.");
        return;
      }
      const blob = new Blob([JSON.stringify(leads, null, 2)], {
        type: "application/json;charset=utf-8;"
      });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "inbotix_sdr_leads.json";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function clearLeads() {
      if (!confirm("Tem certeza que deseja apagar TODOS os leads de inbotix_sdr_leads neste navegador?")) {
        return;
      }
      localStorage.removeItem(SDR_LEADS_KEY);
      leads = [];
      renderLeadsTable();
    }

    btnExportLeadsCsv.addEventListener("click", exportLeadsCsv);
    btnExportLeadsJson.addEventListener("click", exportLeadsJson);
    btnClearLeads.addEventListener("click", clearLeads);

    /* ---------- BOT√ïES GERAIS ---------- */

    btnReload.addEventListener("click", () => {
      loadSdrs();
      loadLeads();
    });

    btnClearAll.addEventListener("click", () => {
      if (!confirm("Tem certeza que deseja limpar TODOS os SDRs deste navegador?")) return;
      localStorage.removeItem(SDR_KEY);
      sdrs = [];
      saveSdrs();
    });

    /* ---------- INIT ---------- */

    function init() {
      loadConfig();
      loadSdrs();
      loadLeads();
    }

    init();
  </script>

  <!-- Microsoft Clarity -->
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "u833ulprni");
  </script>
</body>
</html>
